<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 6.1.1 (Python 3.13.1 on win32)" generated="20251102 14:21:42.865" rpa="false" schemaversion="4">
<suite id="s1" name="Auto test" source="E:\study\S1\taida_cap\PFC_Autotest\Auto_test.robot">
<test id="s1-t1" name="单点效率测试" line="105">
<kw name="Log" library="BuiltIn">
<arg>开始单点效率测试...</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:43.373" level="INFO">开始单点效率测试...</msg>
<status status="PASS" starttime="20251102 14:21:43.373" endtime="20251102 14:21:43.373"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>测试参数: 输入电压=${SOURCE_VOLTAGE}V, 输入限流=${SOURCE_CURRENT}A, 频率=${FREQUENCY}Hz, 负载电流=${LOAD_CURRENT}A</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:43.373" level="INFO">测试参数: 输入电压=220V, 输入限流=4A, 频率=50Hz, 负载电流=1A</msg>
<status status="PASS" starttime="20251102 14:21:43.373" endtime="20251102 14:21:43.373"/>
</kw>
<kw name="开关电源" library="Autotest_Source">
<arg>${INSTRUMENT_SOURCE}</arg>
<arg>0</arg>
<doc>控制电源输出开关
参数说明:
${instrument} - 仪器类型 (APS7100|EC7800)
${state} - 开关状态 (1|0)</doc>
<kw name="Should Be True" library="BuiltIn">
<arg>'${instrument}' in ['APS7100', 'EC7800']</arg>
<arg>不支持的仪器类型: ${instrument} (支持: APS7100, EC7800)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:43.375" endtime="20251102 14:21:43.375"/>
</kw>
<kw name="Should Be True" library="BuiltIn">
<arg>'${state}' in ['0', '1']</arg>
<arg>无效的电源状态: ${state} (应为1或0)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:43.375" endtime="20251102 14:21:43.375"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '1'</arg>
<arg>APS7100_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:43.375" endtime="20251102 14:21:43.375"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '0'</arg>
<arg>APS7100_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_关闭输出" library="AC_Source_APS7100">
<doc>关闭交流电源输出</doc>
<kw name="Set Output" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>OFF</arg>
<doc>设置输出状态 ON/OFF</doc>
<msg timestamp="20251102 14:21:43.383" level="INFO">交流电源[APS-7100, addr=TCPIP0::172.16.5.125::2268::SOCKET, inst_id=2775583939888].</msg>
<status status="PASS" starttime="20251102 14:21:43.376" endtime="20251102 14:21:43.383"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.375" endtime="20251102 14:21:43.383"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.375" endtime="20251102 14:21:43.383"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '1'</arg>
<arg>EC7800_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:43.383" endtime="20251102 14:21:43.383"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '0'</arg>
<arg>EC7800_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:43.383" endtime="20251102 14:21:43.384"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.374" endtime="20251102 14:21:43.384"/>
</kw>
<kw name="开关负载" library="Autotest_Source">
<arg>${INSTRUMENT_LOAD}</arg>
<arg>0</arg>
<doc>控制负载开关，支持IT8800、IT8900
参数说明:
${instrument} - 仪器类型 (IT8800|IT8900)
${state} - 开关状态 (ON|OFF或1|0)</doc>
<kw name="Evaluate" library="BuiltIn">
<var>${onoff}</var>
<arg>'1' if '${state}'.upper() in ['ON', '1'] else ('0' if '${state}'.upper() in ['OFF', '0'] else None)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:43.385" level="INFO">${onoff} = 0</msg>
<status status="PASS" starttime="20251102 14:21:43.385" endtime="20251102 14:21:43.385"/>
</kw>
<kw name="Should Not Be Equal" library="BuiltIn">
<arg>${onoff}</arg>
<arg>None</arg>
<arg>无效的开关状态: ${state} (应为ON/OFF或1/0)</arg>
<doc>Fails if the given objects are equal.</doc>
<status status="PASS" starttime="20251102 14:21:43.385" endtime="20251102 14:21:43.385"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'IT8800'</arg>
<arg>IT8800_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8900'</arg>
<arg>IT8900_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的负载类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="IT8800_设置负载开关" library="DC_Load_IT8800">
<arg>${onoff}</arg>
<doc>设置负载输入开关状态
0: 1=打开, 0=关闭</doc>
<kw name="Set Input State" library="IT8800">
<arg>${IT8800_ADDR}</arg>
<arg>${onoff}</arg>
<doc>设置输入状态 ON/OFF</doc>
<msg timestamp="20251102 14:21:43.433" level="INFO">IT8800电子负载[addr=USB0::0xFFFF::0x8800::600237011697230001::INSTR]已连接.</msg>
<status status="PASS" starttime="20251102 14:21:43.386" endtime="20251102 14:21:43.433"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.386" endtime="20251102 14:21:43.433"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.386" endtime="20251102 14:21:43.434"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.385" endtime="20251102 14:21:43.434"/>
</kw>
<kw name="设置电源" library="Autotest_Source">
<arg>${INSTRUMENT_SOURCE}</arg>
<arg>${SOURCE_VOLTAGE}</arg>
<arg>${SOURCE_CURRENT}</arg>
<arg>${FREQUENCY}</arg>
<doc>统一电源设置关键字
参数说明：
${instrument} - 仪器类型 (APS7100|EC7800)
${voltage} - 要设置的电压值(单位: V)
${current} - 可选，要设置的限流值(单位: A)，默认为None表示不修改电流设置
${fre} - 可选，要设置交流的频率，默认为None
示例:
设置电源 APS7100 220 设置APS7100交流电源220V交流电压
设置电源 EC7800 220 3.0 50设置EC7800电源220V交流电压和3A输出电流限制，50Hz</doc>
<kw name="Should Be True" library="BuiltIn">
<arg>'${instrument}' in ['APS7100', 'EC7800']</arg>
<arg>不支持的仪器类型: ${instrument} (支持: APS7100, EC7800)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:43.438" endtime="20251102 14:21:43.438"/>
</kw>
<kw name="Should Be True" library="BuiltIn">
<arg>${voltage} &gt;= 0</arg>
<arg>电压值不能为负数</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:43.438" endtime="20251102 14:21:43.438"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_设置电压</arg>
<arg>${voltage}</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'EC7800'</arg>
<arg>EC7800_设置电压</arg>
<arg>${voltage}</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的仪器类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_设置电压" library="AC_Source_APS7100">
<arg>${voltage}</arg>
<doc>设置输出电压(V)</doc>
<kw name="Set Voltage" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>${voltage}</arg>
<doc>设置输出电压(V)，自动选择量程</doc>
<status status="PASS" starttime="20251102 14:21:43.439" endtime="20251102 14:21:43.439"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.439" endtime="20251102 14:21:43.440"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.438" endtime="20251102 14:21:43.440"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${current} != ${None}</arg>
<arg>Run Keyword If</arg>
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_设置电流</arg>
<arg>${current}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_设置电流</arg>
<arg>${current}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_设置电流" library="AC_Source_APS7100">
<arg>${current}</arg>
<doc>设置输出电流限制(A)</doc>
<kw name="Set Current" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>${current}</arg>
<doc>设置输出电流限制(A)</doc>
<status status="PASS" starttime="20251102 14:21:43.440" endtime="20251102 14:21:43.441"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.440" endtime="20251102 14:21:43.441"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.440" endtime="20251102 14:21:43.441"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.440" endtime="20251102 14:21:43.441"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${current} != ${None} and '${instrument}' == 'EC7800'</arg>
<arg>EC7800_设置电流</arg>
<arg>${current}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:43.441" endtime="20251102 14:21:43.441"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${fre} != ${None}</arg>
<arg>Run Keyword If</arg>
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_设置频率</arg>
<arg>${fre}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_设置频率</arg>
<arg>${fre}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_设置频率" library="AC_Source_APS7100">
<arg>${fre}</arg>
<doc>设置输出频率(Hz)</doc>
<kw name="Set Frequency" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>${frequency}</arg>
<doc>设置输出频率(Hz)</doc>
<status status="PASS" starttime="20251102 14:21:43.442" endtime="20251102 14:21:43.442"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.442" endtime="20251102 14:21:43.442"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.441" endtime="20251102 14:21:43.442"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.441" endtime="20251102 14:21:43.442"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>${fre} != ${None} and '${instrument}' == 'EC7800'</arg>
<arg>EC7800_设置频率</arg>
<arg>${fre}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:43.442" endtime="20251102 14:21:43.443"/>
</kw>
<status status="PASS" starttime="20251102 14:21:43.437" endtime="20251102 14:21:43.443"/>
</kw>
<kw name="Sleep" library="BuiltIn">
<arg>1s</arg>
<doc>Pauses the test executed for the given time.</doc>
<msg timestamp="20251102 14:21:44.443" level="INFO">Slept 1 second</msg>
<status status="PASS" starttime="20251102 14:21:43.443" endtime="20251102 14:21:44.443"/>
</kw>
<kw name="开关电源" library="Autotest_Source">
<arg>${INSTRUMENT_SOURCE}</arg>
<arg>1</arg>
<doc>控制电源输出开关
参数说明:
${instrument} - 仪器类型 (APS7100|EC7800)
${state} - 开关状态 (1|0)</doc>
<kw name="Should Be True" library="BuiltIn">
<arg>'${instrument}' in ['APS7100', 'EC7800']</arg>
<arg>不支持的仪器类型: ${instrument} (支持: APS7100, EC7800)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:44.445" endtime="20251102 14:21:44.445"/>
</kw>
<kw name="Should Be True" library="BuiltIn">
<arg>'${state}' in ['0', '1']</arg>
<arg>无效的电源状态: ${state} (应为1或0)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:44.445" endtime="20251102 14:21:44.445"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '1'</arg>
<arg>APS7100_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_打开输出" library="AC_Source_APS7100">
<doc>开启交流电源输出</doc>
<kw name="Set Output" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>ON</arg>
<doc>设置输出状态 ON/OFF</doc>
<status status="PASS" starttime="20251102 14:21:44.446" endtime="20251102 14:21:44.446"/>
</kw>
<status status="PASS" starttime="20251102 14:21:44.446" endtime="20251102 14:21:44.446"/>
</kw>
<status status="PASS" starttime="20251102 14:21:44.445" endtime="20251102 14:21:44.446"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '0'</arg>
<arg>APS7100_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:44.446" endtime="20251102 14:21:44.446"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '1'</arg>
<arg>EC7800_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:44.446" endtime="20251102 14:21:44.446"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '0'</arg>
<arg>EC7800_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:44.446" endtime="20251102 14:21:44.447"/>
</kw>
<status status="PASS" starttime="20251102 14:21:44.445" endtime="20251102 14:21:44.447"/>
</kw>
<kw name="Sleep" library="BuiltIn">
<arg>2s</arg>
<doc>Pauses the test executed for the given time.</doc>
<msg timestamp="20251102 14:21:46.447" level="INFO">Slept 2 seconds</msg>
<status status="PASS" starttime="20251102 14:21:44.447" endtime="20251102 14:21:46.447"/>
</kw>
<kw name="设置负载模式" library="Autotest_Source">
<arg>${INSTRUMENT_LOAD}</arg>
<arg>CC</arg>
<arg>${LOAD_CURRENT}</arg>
<arg>0</arg>
<doc>设置负载工作模式
参数说明:
${instrument} - 仪器类型 (IT8800|IT8900)
${mode} - 负载模式 (CC|CV|CR)
${value} - 模式设定值 (CC:A, CV:V, CR:Ω)
${state} - 负载开关状态 (ON|OFF或1|0, 默认OFF)</doc>
<kw name="Should Be True" library="BuiltIn">
<arg>'${instrument}' in ['IT8800', 'IT8900']</arg>
<arg>不支持的负载类型: ${instrument}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:46.450" endtime="20251102 14:21:46.451"/>
</kw>
<kw name="Should Be True" library="BuiltIn">
<arg>'${mode}' in ['CC', 'CV', 'CR']</arg>
<arg>不支持的负载模式: ${mode}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:46.451" endtime="20251102 14:21:46.451"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${onoff}</var>
<arg>'1'if '${state}'.upper() in ['ON', '1'] else ('0' if '${state}'.upper() in ['OFF', '0'] else None)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:46.451" level="INFO">${onoff} = 0</msg>
<status status="PASS" starttime="20251102 14:21:46.451" endtime="20251102 14:21:46.451"/>
</kw>
<kw name="Should Not Be Equal" library="BuiltIn">
<arg>${onoff}</arg>
<arg>None</arg>
<arg>无效的开关状态: ${state} (应为ON/OFF或1/0)</arg>
<doc>Fails if the given objects are equal.</doc>
<status status="PASS" starttime="20251102 14:21:46.451" endtime="20251102 14:21:46.451"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'IT8800'</arg>
<arg>Run Keywords</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CC'</arg>
<arg>IT8800_设置恒流模式负载电流值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CV'</arg>
<arg>IT8800_设置恒压模式负载电压值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CR'</arg>
<arg>IT8800_设置恒阻模式负载电阻值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="Run Keywords" library="BuiltIn">
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CC'</arg>
<arg>IT8800_设置恒流模式负载电流值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CV'</arg>
<arg>IT8800_设置恒压模式负载电压值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CR'</arg>
<arg>IT8800_设置恒阻模式负载电阻值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Executes all the given keywords in a sequence.</doc>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${mode}' == 'CC'</arg>
<arg>IT8800_设置恒流模式负载电流值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="IT8800_设置恒流模式负载电流值" library="DC_Load_IT8800">
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>设置恒流模式的电流值
${current}: 电流值，单位A</doc>
<kw name="Set Cc Current" library="IT8800">
<arg>${IT8800_ADDR}</arg>
<arg>${current}</arg>
<doc>设置CC模式电流值</doc>
<status status="PASS" starttime="20251102 14:21:46.453" endtime="20251102 14:21:46.454"/>
</kw>
<kw name="Set Input State" library="IT8800">
<arg>${IT8800_ADDR}</arg>
<arg>${onoff}</arg>
<doc>设置输入状态 ON/OFF</doc>
<status status="PASS" starttime="20251102 14:21:46.454" endtime="20251102 14:21:46.454"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.453" endtime="20251102 14:21:46.454"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.452" endtime="20251102 14:21:46.454"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${mode}' == 'CV'</arg>
<arg>IT8800_设置恒压模式负载电压值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:46.454" endtime="20251102 14:21:46.454"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${mode}' == 'CR'</arg>
<arg>IT8800_设置恒阻模式负载电阻值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:46.454" endtime="20251102 14:21:46.455"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.452" endtime="20251102 14:21:46.455"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.452" endtime="20251102 14:21:46.455"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'IT8900'</arg>
<arg>Run Keywords</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CC'</arg>
<arg>IT8900_设置恒流模式负载电流值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CV'</arg>
<arg>IT8900_设置恒压模式负载电压值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<arg>AND</arg>
<arg>Run Keyword If</arg>
<arg>'${mode}' == 'CR'</arg>
<arg>IT8900_设置恒阻模式负载电阻值</arg>
<arg>${value}</arg>
<arg>${onoff}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:46.455" endtime="20251102 14:21:46.455"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.450" endtime="20251102 14:21:46.455"/>
</kw>
<kw name="开关负载" library="Autotest_Source">
<arg>${INSTRUMENT_LOAD}</arg>
<arg>1</arg>
<doc>控制负载开关，支持IT8800、IT8900
参数说明:
${instrument} - 仪器类型 (IT8800|IT8900)
${state} - 开关状态 (ON|OFF或1|0)</doc>
<kw name="Evaluate" library="BuiltIn">
<var>${onoff}</var>
<arg>'1' if '${state}'.upper() in ['ON', '1'] else ('0' if '${state}'.upper() in ['OFF', '0'] else None)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:46.456" level="INFO">${onoff} = 1</msg>
<status status="PASS" starttime="20251102 14:21:46.456" endtime="20251102 14:21:46.456"/>
</kw>
<kw name="Should Not Be Equal" library="BuiltIn">
<arg>${onoff}</arg>
<arg>None</arg>
<arg>无效的开关状态: ${state} (应为ON/OFF或1/0)</arg>
<doc>Fails if the given objects are equal.</doc>
<status status="PASS" starttime="20251102 14:21:46.457" endtime="20251102 14:21:46.457"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'IT8800'</arg>
<arg>IT8800_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8900'</arg>
<arg>IT8900_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的负载类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="IT8800_设置负载开关" library="DC_Load_IT8800">
<arg>${onoff}</arg>
<doc>设置负载输入开关状态
1: 1=打开, 0=关闭</doc>
<kw name="Set Input State" library="IT8800">
<arg>${IT8800_ADDR}</arg>
<arg>${onoff}</arg>
<doc>设置输入状态 ON/OFF</doc>
<status status="PASS" starttime="20251102 14:21:46.457" endtime="20251102 14:21:46.458"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.457" endtime="20251102 14:21:46.458"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.457" endtime="20251102 14:21:46.458"/>
</kw>
<status status="PASS" starttime="20251102 14:21:46.456" endtime="20251102 14:21:46.458"/>
</kw>
<kw name="Sleep" library="BuiltIn">
<arg>4s</arg>
<doc>Pauses the test executed for the given time.</doc>
<msg timestamp="20251102 14:21:50.458" level="INFO">Slept 4 seconds</msg>
<status status="PASS" starttime="20251102 14:21:46.458" endtime="20251102 14:21:50.459"/>
</kw>
<kw name="测量功率" library="Autotest_Source">
<var>${input_power}</var>
<arg>${INSTRUMENT_IN}</arg>
<doc>统一功率测量关键字
参数说明：
${instrument} - 仪器类型 (ZXB001|ZXB002|APS7100|EC7800|IT8800|IT8900)
返回值：测量得到的功率
示例：
${result} = 测量功率 APS7100 使用交流源APS7100读取功率
${result} = 测量功率 ZXB001 使用ZXB001读取功率</doc>
<kw name="Run Keyword If" library="BuiltIn">
<var>${result}</var>
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'EC7800'</arg>
<arg>EC7800_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8800'</arg>
<arg>IT8800_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8900'</arg>
<arg>IT8900_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'ZXB001'</arg>
<arg>ZXB001_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'ZXB002'</arg>
<arg>ZXB002_测量功率</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的仪器类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_测量功率" library="AC_Source_APS7100">
<doc>测量实际输出功率</doc>
<kw name="Measure Power" library="APS7100">
<var>${power}</var>
<arg>${AC_Source_ADDR}</arg>
<doc>测量实际输出功率</doc>
<msg timestamp="20251102 14:21:50.469" level="INFO">${power} = 405.026</msg>
<status status="PASS" starttime="20251102 14:21:50.462" endtime="20251102 14:21:50.469"/>
</kw>
<status status="PASS" starttime="20251102 14:21:50.462" endtime="20251102 14:21:50.469"/>
</kw>
<msg timestamp="20251102 14:21:50.469" level="INFO">${result} = 405.026</msg>
<status status="PASS" starttime="20251102 14:21:50.462" endtime="20251102 14:21:50.469"/>
</kw>
<msg timestamp="20251102 14:21:50.469" level="INFO">${input_power} = 405.026</msg>
<status status="PASS" starttime="20251102 14:21:50.461" endtime="20251102 14:21:50.469"/>
</kw>
<kw name="测量功率" library="Autotest_Source">
<var>${output_power}</var>
<arg>${INSTRUMENT_OUT}</arg>
<doc>统一功率测量关键字
参数说明：
${instrument} - 仪器类型 (ZXB001|ZXB002|APS7100|EC7800|IT8800|IT8900)
返回值：测量得到的功率
示例：
${result} = 测量功率 APS7100 使用交流源APS7100读取功率
${result} = 测量功率 ZXB001 使用ZXB001读取功率</doc>
<kw name="Run Keyword If" library="BuiltIn">
<var>${result}</var>
<arg>'${instrument}' == 'APS7100'</arg>
<arg>APS7100_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'EC7800'</arg>
<arg>EC7800_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8800'</arg>
<arg>IT8800_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8900'</arg>
<arg>IT8900_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'ZXB001'</arg>
<arg>ZXB001_测量功率</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'ZXB002'</arg>
<arg>ZXB002_测量功率</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的仪器类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="IT8800_测量功率" library="DC_Load_IT8800">
<doc>测量负载功率，单位W</doc>
<kw name="Measure Power" library="IT8800">
<var>${power}</var>
<arg>${IT8800_ADDR}</arg>
<doc>测量功率</doc>
<msg timestamp="20251102 14:21:50.474" level="INFO">${power} = 399.658</msg>
<status status="PASS" starttime="20251102 14:21:50.473" endtime="20251102 14:21:50.474"/>
</kw>
<status status="PASS" starttime="20251102 14:21:50.473" endtime="20251102 14:21:50.474"/>
</kw>
<msg timestamp="20251102 14:21:50.474" level="INFO">${result} = 399.658</msg>
<status status="PASS" starttime="20251102 14:21:50.472" endtime="20251102 14:21:50.474"/>
</kw>
<msg timestamp="20251102 14:21:50.474" level="INFO">${output_power} = 399.658</msg>
<status status="PASS" starttime="20251102 14:21:50.472" endtime="20251102 14:21:50.474"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${efficiency}</var>
<arg>(${output_power} / ${input_power}) * 100</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:50.475" level="INFO">${efficiency} = 98.67465298524046</msg>
<status status="PASS" starttime="20251102 14:21:50.474" endtime="20251102 14:21:50.475"/>
</kw>
<kw name="Evaluate" library="BuiltIn">
<var>${efficiency}</var>
<arg>round(${efficiency}, 2)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:50.475" level="INFO">${efficiency} = 98.67</msg>
<status status="PASS" starttime="20251102 14:21:50.475" endtime="20251102 14:21:50.475"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>输入功率: ${input_power} W</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:50.475" level="INFO">输入功率: 405.026 W</msg>
<status status="PASS" starttime="20251102 14:21:50.475" endtime="20251102 14:21:50.475"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>输出功率: ${output_power} W</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:50.475" level="INFO">输出功率: 399.658 W</msg>
<status status="PASS" starttime="20251102 14:21:50.475" endtime="20251102 14:21:50.475"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>效率: ${efficiency}%</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:50.476" level="INFO">效率: 98.67%</msg>
<status status="PASS" starttime="20251102 14:21:50.475" endtime="20251102 14:21:50.476"/>
</kw>
<kw name="开关电源" library="Autotest_Source">
<arg>${INSTRUMENT_SOURCE}</arg>
<arg>0</arg>
<doc>控制电源输出开关
参数说明:
${instrument} - 仪器类型 (APS7100|EC7800)
${state} - 开关状态 (1|0)</doc>
<kw name="Should Be True" library="BuiltIn">
<arg>'${instrument}' in ['APS7100', 'EC7800']</arg>
<arg>不支持的仪器类型: ${instrument} (支持: APS7100, EC7800)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:50.478" endtime="20251102 14:21:50.478"/>
</kw>
<kw name="Should Be True" library="BuiltIn">
<arg>'${state}' in ['0', '1']</arg>
<arg>无效的电源状态: ${state} (应为1或0)</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" starttime="20251102 14:21:50.478" endtime="20251102 14:21:50.478"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '1'</arg>
<arg>APS7100_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:50.478" endtime="20251102 14:21:50.479"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'APS7100' and '${state}' == '0'</arg>
<arg>APS7100_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="APS7100_关闭输出" library="AC_Source_APS7100">
<doc>关闭交流电源输出</doc>
<kw name="Set Output" library="APS7100">
<arg>${AC_Source_ADDR}</arg>
<arg>OFF</arg>
<doc>设置输出状态 ON/OFF</doc>
<status status="PASS" starttime="20251102 14:21:50.479" endtime="20251102 14:21:50.479"/>
</kw>
<status status="PASS" starttime="20251102 14:21:50.479" endtime="20251102 14:21:50.479"/>
</kw>
<status status="PASS" starttime="20251102 14:21:50.479" endtime="20251102 14:21:50.479"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '1'</arg>
<arg>EC7800_打开输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:50.480" endtime="20251102 14:21:50.480"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'EC7800' and '${state}' == '0'</arg>
<arg>EC7800_关闭输出</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" starttime="20251102 14:21:50.480" endtime="20251102 14:21:50.480"/>
</kw>
<status status="PASS" starttime="20251102 14:21:50.477" endtime="20251102 14:21:50.480"/>
</kw>
<kw name="Sleep" library="BuiltIn">
<arg>3s</arg>
<doc>Pauses the test executed for the given time.</doc>
<msg timestamp="20251102 14:21:53.481" level="INFO">Slept 3 seconds</msg>
<status status="PASS" starttime="20251102 14:21:50.480" endtime="20251102 14:21:53.481"/>
</kw>
<kw name="开关负载" library="Autotest_Source">
<arg>${INSTRUMENT_LOAD}</arg>
<arg>0</arg>
<doc>控制负载开关，支持IT8800、IT8900
参数说明:
${instrument} - 仪器类型 (IT8800|IT8900)
${state} - 开关状态 (ON|OFF或1|0)</doc>
<kw name="Evaluate" library="BuiltIn">
<var>${onoff}</var>
<arg>'1' if '${state}'.upper() in ['ON', '1'] else ('0' if '${state}'.upper() in ['OFF', '0'] else None)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<msg timestamp="20251102 14:21:53.484" level="INFO">${onoff} = 0</msg>
<status status="PASS" starttime="20251102 14:21:53.483" endtime="20251102 14:21:53.484"/>
</kw>
<kw name="Should Not Be Equal" library="BuiltIn">
<arg>${onoff}</arg>
<arg>None</arg>
<arg>无效的开关状态: ${state} (应为ON/OFF或1/0)</arg>
<doc>Fails if the given objects are equal.</doc>
<status status="PASS" starttime="20251102 14:21:53.484" endtime="20251102 14:21:53.484"/>
</kw>
<kw name="Run Keyword If" library="BuiltIn">
<arg>'${instrument}' == 'IT8800'</arg>
<arg>IT8800_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE IF</arg>
<arg>'${instrument}' == 'IT8900'</arg>
<arg>IT8900_设置负载开关</arg>
<arg>${onoff}</arg>
<arg>ELSE</arg>
<arg>Fail</arg>
<arg>不支持的负载类型: ${instrument}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<kw name="IT8800_设置负载开关" library="DC_Load_IT8800">
<arg>${onoff}</arg>
<doc>设置负载输入开关状态
0: 1=打开, 0=关闭</doc>
<kw name="Set Input State" library="IT8800">
<arg>${IT8800_ADDR}</arg>
<arg>${onoff}</arg>
<doc>设置输入状态 ON/OFF</doc>
<status status="PASS" starttime="20251102 14:21:53.485" endtime="20251102 14:21:53.485"/>
</kw>
<status status="PASS" starttime="20251102 14:21:53.484" endtime="20251102 14:21:53.485"/>
</kw>
<status status="PASS" starttime="20251102 14:21:53.484" endtime="20251102 14:21:53.485"/>
</kw>
<status status="PASS" starttime="20251102 14:21:53.483" endtime="20251102 14:21:53.485"/>
</kw>
<kw name="Log" library="BuiltIn">
<arg>单点效率测试完成</arg>
<doc>Logs the given message with the given level.</doc>
<msg timestamp="20251102 14:21:53.486" level="INFO">单点效率测试完成</msg>
<status status="PASS" starttime="20251102 14:21:53.485" endtime="20251102 14:21:53.486"/>
</kw>
<doc>单点效率测试 - 在特定工作点测量效率
使用方式:
robot --variable INSTRUMENT_SOURCE:APS7100 --variable INSTRUMENT_LOAD:IT8800 --variable INSTRUMENT_IN:ZXB001 --variable INSTRUMENT_OUT:ZXB002 --variable SOURCE_VOLTAGE:220 --variable SOURCE_CURRENT:5.0 --variable FREQUENCY:50 --variable LOAD_CURRENT:2.0 STM32_Test_Suite.robot</doc>
<tag>efficiency</tag>
<tag>single-point</tag>
<status status="PASS" starttime="20251102 14:21:43.371" endtime="20251102 14:21:53.486"/>
</test>
<status status="PASS" starttime="20251102 14:21:42.876" endtime="20251102 14:21:53.487"/>
</suite>
<statistics>
<total>
<stat pass="1" fail="0" skip="0">All Tests</stat>
</total>
<tag>
<stat pass="1" fail="0" skip="0">efficiency</stat>
<stat pass="1" fail="0" skip="0">single-point</stat>
</tag>
<suite>
<stat pass="1" fail="0" skip="0" id="s1" name="Auto test">Auto test</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
